# Smoldyn configuration file for a highly simplified liver cell model focused on iron metabolism (iron-core model)


# Definitions
# ===========
# Bimolecular reactions (second-order rate constants)
define SIGMA_Fpn_Export     1e6   # Fpn_Export (LIP + LIP → Tf-Fe_intercell) (um^3/s)
define SIGMA_TfR1_binding    1e6   # TfR1_binding (Tf-Fe_intercell + TfR → Tf-Fe-TfR1) (um^3/s)
define SIGMA_Ferritin_Iron_Binding 5e6  # Ferritin_Iron_Binding (LIP + FT → Fe-FT) (um^3/s)

# Unimolecular reactions (first-order rate constants)
define SIGMA_TfR1_expression   0.01   # TfR1_expression (TfR) (s^-1)
define SIGMA_TfR1_degradation  0.001  # TfR1_degradation (TfR →) (s^-1)
define SIGMA_Ferroportin_Expression 0.01  # Ferroportin_Expression (Fpn) (s^-1)
define SIGMA_Ferritin_Iron_Release 0.01  # Ferritin_Iron_Release (Fe-FT → LIP + FT) (s^-1)

# Time params
define TIME_START 0
define TIME_STOP 10
define TIME_STEP 0.002

# Geometric params
define CELL_RADIUS 40
define CELL_LENGTH 40


# General simulation setup
# ========================
random_seed 1
dim 3
boundaries x -CELL_RADIUS CELL_RADIUS
boundaries y -CELL_RADIUS CELL_RADIUS
boundaries z -CELL_RADIUS CELL_RADIUS
frame_thickness 0
time_start TIME_START
time_stop TIME_STOP 
time_step TIME_STEP  # Time step size (s)


# Species specifications
# ======================
species LIP 
species TfR 
species Tf-Fe_intercell 
species Fpn 
species Fe-FT
species FT
species Tf-Fe-TfR1

# Diffusion coefficients
difc LIP(solution) 89.37
difc TfR(solution) 7.81
difc Fpn(solution) 8.59
difc Fe-FT(solution) 4.17
difc Tf-Fe_intercell(solution) 8.11
difc Tf-Fe-TfR1(solution) 6.30

# Visual properties
color LIP(solution) green
color TfR(solution) red
color Fpn(solution) yellow
color Fe-FT(solution) white
color Tf-Fe_intercell(solution) orange
color FT(solution) blue
color Tf-Fe-TfR1(solution) purple

# Display sizes for each species (relative to LIP)
display_size LIP(solution) 1           # LIP (smallest)
display_size TfR(solution) 14.7        # TfR (transferrin receptor)
display_size Tf-Fe_intercell(solution) 11.2  # Transferrin bound to iron
display_size Fpn(solution) 10.3        # Fpn (ferroportin)
display_size Fe-FT(solution) 20.3      # Ferritin-bound iron
display_size FT(solution) 20.3         # Ferritin (without iron)
display_size Tf-Fe-TfR1(solution) 13  # transferrin bound to iron and transferrin receptor 1


# Reactions
# =========
# Bimolecular Reactions (Second-order rate constants)
reaction Fpn_Export LIP + LIP -> Tf-Fe_intercell 1e6
reaction TfR1_binding Tf-Fe_intercell + TfR -> Tf-Fe-TfR1 1e6
reaction Ferritin_Iron_Binding LIP + FT -> Fe-FT 5e6

# Unimolecular Reactions (First-order rate constants)
reaction TfR1_expression 0 -> TfR 1e-2
reaction TfR1_degradation TfR -> 0 1e-3
reaction Ferroportin_Expression 0 -> Fpn 1e-2
reaction Ferritin_Iron_Release Fe-FT -> LIP + FT 1e-2


# Set up the cell as a spherical boundary
# =======================================
start_surface sphere_surface
    action both all reflect
    polygon both face
    panel sphere 0 0 0 CELL_RADIUS CELL_RADIUS CELL_RADIUS
end_surface


# Inside compartment
# ==================
start_compartment cell
    surface sphere_surface
    point 0 0 0
end_compartment


# Initialize Molecules in the sphere
# ==================================
compartment_mol 100 LIP cell  # Initial LIP molecules
compartment_mol 20 TfR cell  # Initial TfR molecules
compartment_mol 50 Fe-FT cell  # Initial Fe-FT molecules
compartment_mol 50 FT cell  # Initial FT molecules
compartment_mol 20 Tf-Fe_intercell cell  # Initial Tf-Fe_intercell molecules
compartment_mol 100 Fpn cell  # Initial Fpn molecules
compartment_mol 10 Tf-Fe-TfR1 cell  # Initial Tf-Fe-TfR1 molecules


# Output settings
# ===============
output_files model_out.txt
cmd i 0 TIME_STOP 1 executiontime model_out.txt
cmd i 0 TIME_STOP 1 listmols model_out.txt

end_file
