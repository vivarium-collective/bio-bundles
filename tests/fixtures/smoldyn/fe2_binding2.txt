# Smoldyn configuration file for modeling the particlar inner-cell cycle in which Fe²⁺ (LIP) binds to Ferritin (FT) as per BIOMD0000000498 (Mitchell, Mendes, 2013)
# Author: Alexander A. Patrie 10/2024

# - This cycle is orders of magnitutde faster than the rest of model reactions. This cycle has been separated to reduce stiffness
# - This model uses hydroxyl radical (•OH) and superoxide anion as the primary reactive oxygen species 
# - This model relates specifically to the distribution/use of ferrous iron internally within the cell itself.
# - TODO: create another model/process relating specifically to Fe export (hamp(hepcidin), fpn(ferroportin), etc).
# - TODO: include oxidative stress and membrane damage by adding ROS1 + Memb -> Memb_damaged (also include PDE)


# -- Param definitions
define TIME_START 0
define TIME_STOP 500
define TIME_STEP 0.002

define L_PARAM 15  # half of cell l
define L_PARAM2 5 # half of cell length minus radius
define R 10  # cell radius

define ROS1_THRESHOLD 501  # *OH is more damaging than O2- TODO: make this threshold subscribe-able to the Lysosomes
define ROS2_THRESHOLD 1001

define P_D 0.09  # large protein complexes (FT, etc) difc
define E_D 0.2  # enzyme (Catalase, etc) difc
define SMOL_D 0.8  # small molecules difc
define O_D 0.005  # lysosomic (organelle) difc

define SIGMA_B 0.07  # k for binding rxns
define SIGMA_D 0.03  # k for degredation rxns
define SIGMA_E 0.05  # k for enzymatic rxns (avg)
define SIGMA_NS 1.0  # k for namespace conversion (FT1 -> FT)
define SIGMA_HR 0.2  # k for highly reactive rxns (stress2)


# -- General simulation setup
dim 3
boundaries 0 -L_PARAM L_PARAM
boundaries 1 -R R
boundaries 2 -R R

random_seed 1
frame_thickness 0

time_start TIME_START
time_stop TIME_STOP
time_step TIME_STEP

accuracy 5
molperbox 4


# -- Metabolism
species LIP  # Freely-floating Fe ferrous iron (labile iron pool)
species FT  # Ferritin not yet bound with Fe
species Fe-FT  # Fe that is bound to ferritin and ready to be used
species FT1  # Internalized ferritin whose Fe stores has been used)
species Lysosome  # membrane bound organelle

# -- Oxidative stress and ROS detoxification
species ROS1  # reactive oxygen species (•OH hydroxyl radical)
species ROS2  # reactive oxygen species (O₂⁻ superoxide anion)
species SOD  # superoxide dismutase responsible for stage1 of ROS2 removal
species Catalase  # enzyme responsible for fully detoxifying ROS2
species H2O2  # hydrogen peroxide (both a signaling molecule AND a contributor to ROS production in fenton reaction)
species H2O  # water byproduct of ROS2 detoxification
species O2  # same byproduct
species OH  # hydroxide ion byproduct of fenton reaction
# species Memb  # cell membrane(fixed in place)
# species Memb_damaged  # damaged cell membrane (replaces Memb instance)

# -- Iron reduction
species Fe3  # ferric iron byproduct of fenton reaction
species Asc  # anti-oxidant vitamin C reducing agent to convert ferric into ferrous iron ascorbate
species DHA  # anti-oxidant byproduct of ferric-ferrous iron conversion dehydroascorbate


# -- Molecule lists TODO: in the full model, place these lists inside of ONE list called iron_metabolism which determines the overall stiffness
molecule_lists iron_metabolism oxidative_stress iron_reduction

mol_list LIP(solution) iron_metabolism
mol_list FT(solution) iron_metabolism
mol_list Fe-FT(solution) iron_metabolism
mol_list FT1(solution) iron_metabolism
mol_list Lysosome(solution) iron_metabolism

mol_list ROS1(solution) oxidative_stress
mol_list ROS2(solution) oxidative_stress
mol_list SOD(solution) oxidative_stress
mol_list Catalase(solution) oxidative_stress
mol_list H2O2(solution) oxidative_stress
mol_list H2O(solution) oxidative_stress
mol_list O2(solution) oxidative_stress
mol_list OH(solution) oxidative_stress

mol_list Fe3(solution) iron_reduction
mol_list Asc(solution) iron_reduction
mol_list DHA(solution) iron_reduction


# -- Diffusion coefficients
difc LIP(solution) SMOL_D  # 89.37
difc FT(solution) P_D  
difc Fe-FT(solution) P_D  
difc FT1(solution) P_D  # 20.3
difc Lysosome(solution) O_D  # very slow cytoplasmic diffusion

difc ROS1(solution) SMOL_D  # very fast *OH (hydroxyl) 
difc ROS2(solution) SMOL_D  # very fast O2 (superoxide anion)
difc SOD(solution) E_D
difc Catalase(solution) E_D
difc H2O2(solution) SMOL_D
difc H2O(solution) SMOL_D
difc O2(solution) SMOL_D
difc OH(solution) SMOL_D

difc Fe3(solution) SMOL_D
difc Asc(solution) SMOL_D
difc DHA(solution) SMOL_D


# -- Reactions(Binding, internalization, and release)
reaction mtbl1 LIP(solution) + FT(solution) -> Fe-FT(solution) SIGMA_B  # iron binding to ferritin
reaction mtbl2 Fe-FT(solution) + Lysosome(solution) -> LIP(solution) + FT1(solution) SIGMA_E  # iron release
reaction mtbl3 FT1(solution) -> FT(solution) SIGMA_NS  # namespace change of FT1 to FT which will then be re-used

# -- Reactions(Oxidative stress)
reaction stress1 LIP(solution) + H2O2(solution) -> Fe3(solution) + ROS1(solution) + OH(solution) SIGMA_HR  # creation of hydroxl radical
reaction stress2 FT1(solution) + Lysosome(solution) -> 0 SIGMA_D  # lysosomic degredation of FT1, which in turn reduces the amount of FT

# -- Reactions(ROS2 detox)
reaction detox1 ROS2(solution) + SOD(solution) -> H2O2(solution) SIGMA_E  # ROS2 detox stage I
reaction detox2 H2O2(solution) + Catalase(solution) -> H2O(solution) + O2(solution) SIGMA_E  # ROS2 detox stage II

# -- Reactions(iron reduction in response to ferric iron production from stress1)
reaction redux Fe3(solution) + Asc(solution) -> LIP(solution) + DHA(solution) SIGMA_B  # from ferric to ferrous


# -- Set up the cell as a spherical boundary
start_surface membrane
    # action both all reflect
    # polygon both face
    # panel sphere 0 0 0 R R R 

    # rate <SPEC NAME> fsoln front <k>
    action both all reflect
    polygon both edge
    panel cylinder -L_PARAM2 0 0 L_PARAM2 0 0 -R 20 10 cyl0
    panel hemi -L_PARAM2 0 0 -R 1 0 0 20 5 hemi0
    panel hemi L_PARAM2 0 0 -R -1 0 0 20 5 hemi1
    neighbors cyl0 hemi0 hemi1
    neighbors hemi0 cyl0
    neighbors hemi1 cyl0
end_surface


# -- Inside compartment
start_compartment cytoplasm
    surface membrane
    point 0 0 0
end_compartment


# -- Initialize Molecules in the cytplsm
compartment_mol 50 LIP cytoplasm 
compartment_mol 70 FT cytoplasm 
compartment_mol 10 Fe-FT cytoplasm 
compartment_mol 80 Lysosome cytoplasm 
compartment_mol 30 SOD cytoplasm 
compartment_mol 30 Catalase cytoplasm
compartment_mol 40 Asc cytoplasm
compartment_mol 10 DHA cytoplasm 

compartment_mol 10 FT1 cytoplasm 
compartment_mol 10 ROS1 cytoplasm 
compartment_mol 10 ROS2 cytoplasm 
compartment_mol 1 H2O2 cytoplasm 
compartment_mol 100 H2O cytoplasm 
compartment_mol 100 O2 cytoplasm 
compartment_mol 10 OH cytoplasm 
compartment_mol 1 Fe3 cytoplasm 
compartment_mol 2 ROS1 cytoplasm
compartment_mol 2 ROS2 cytoplasm


# -- Output settings
output_files model_out.txt
cmd i 0 TIME_STOP 1 executiontime model_out.txt
cmd i 0 TIME_STOP 1 listmols model_out.txt

end_file
