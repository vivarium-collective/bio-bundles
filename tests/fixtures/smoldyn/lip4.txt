# Smoldyn configuration file for simplified liver cell model (simplified lip3) focusing on iron metabolism


# Definitions
# ===========
# Bimolecular reactions (second-order rate constants)
define SIGMA_Fpn_Export     1e6   # Fpn_Export (LIP + LIP → Tf-Fe_intercell) (um^3/s)
define SIGMA_TfR1_binding    1e6   # TfR1_binding (Tf-Fe_intercell + TfR → Tf-Fe-TfR1) (um^3/s)
define SIGMA_TfR2_binding    1e6   # TfR2_binding (Tf-Fe_intercell + TfR2 → Tf-Fe-TfR2) (um^3/s)
define SIGMA_Ferritin_Iron_Binding 5e6  # Ferritin_Iron_Binding (LIP + FT → Fe-FT) (um^3/s)

# Unimolecular reactions (first-order rate constants)
define SIGMA_TfR1_expression   0.01   # TfR1_expression (TfR) (s^-1)
define SIGMA_TfR1_degradation  0.001  # TfR1_degradation (TfR →) (s^-1)
define SIGMA_Ferroportin_Expression 0.01  # Ferroportin_Expression (Fpn) (s^-1)
define SIGMA_HFE_expression    0.01   # HFE_expression (HFE) (s^-1)
define SIGMA_HFE_degradation   0.001  # HFE_degradation (HFE →) (s^-1)
define SIGMA_TfR2_expression   0.01   # TfR2_expression (TfR2) (s^-1)
define SIGMA_TfR2_degradation  0.001  # TfR2_degradation (TfR2 →) (s^-1)
define SIGMA_Hamp_expression   0.01   # Hamp_expression (Hamp) (s^-1)
define SIGMA_Hamp_degradation  0.001  # Hamp_degradation (Hamp →) (s^-1)
define SIGMA_Ferritin_Iron_Release 0.01  # Ferritin_Iron_Release (Fe-FT → LIP + FT) (s^-1)

# Time params
define TIME_START 0
define TIME_STOP 10
define TIME_STEP 0.02

# Geometric params
define CELL_LENGTH 20
define CELL_RADIUS 20


# General simulation setup
# ========================
random_seed 1
dim 3
boundaries x -CELL_LENGTH CELL_LENGTH
boundaries y -CELL_LENGTH CELL_LENGTH
boundaries z -CELL_LENGTH CELL_LENGTH
frame_thickness 0
time_start 0
time_stop TIME_STOP 
time_step 0.002  # Time step size (s)


# Define species
# ==============
species Hamp 
species Fe-FT 
species FT 
species TfR 
species Tf-Fe_intercell 
species Fpn 
species HFE 
species TfR2 
species LIP
species Tf-Fe-TfR1
species Tf-Fe-TfR2

# Diffusion coefficients
difc LIP(solution) 89.37
difc TfR(solution) 7.81
difc Fpn(solution) 8.59
difc Hamp(solution) 24.38
difc HFE(solution) 10.19
difc Tf-Fe_intercell(solution) 8.11
difc Fe-FT(solution) 4.17

# Visual properties
color LIP(solution) green
color TfR(solution) red
color Fpn(solution) yellow
color Hamp(solution) magenta
color HFE(solution) cyan
color Fe-FT(solution) white
color Tf-Fe_intercell(solution) orange
display_size all(solution) 2
# display_size LIP(solution) 2
# display_size TfR(solution) 2
# display_size Fpn(solution) 2


# Reactions
# =========
# Bimolecular Reactions (Second-order rate constants)
reaction Fpn_Export LIP + LIP -> Tf-Fe_intercell 1e6
reaction TfR1_binding Tf-Fe_intercell + TfR -> Tf-Fe-TfR1 1e6
reaction TfR2_binding Tf-Fe_intercell + TfR2 -> Tf-Fe-TfR2 1e6
reaction Ferritin_Iron_Binding LIP + FT -> Fe-FT 5e6

# Unimolecular Reactions (First-order rate constants)
reaction TfR1_expression 0 -> TfR 1e-2
reaction TfR1_degradation TfR -> 0 1e-3
reaction Ferroportin_Expression 0 -> Fpn 1e-2
reaction HFE_expression 0 -> HFE 1e-2
reaction HFE_degradation HFE -> 0 1e-3
reaction TfR2_expression 0 -> TfR2 1e-2
reaction TfR2_degradation TfR2 -> 0 1e-3
reaction Hamp_expression 0 -> Hamp 1e-2
reaction Hamp_degradation Hamp -> 0 1e-3
reaction Ferritin_Iron_Release Fe-FT -> LIP + FT 1e-2


# Set up the cell as a spherical boundary
# =======================================
start_surface sphere_surface
    action both all reflect
    polygon both face
    panel sphere 10 10 10  10  20 20
end_surface


# Inside compartment
# ==================
start_compartment cell
    surface sphere_surface
    point 0 0 0
end_compartment


# Initialize Molecules in the sphere
# ==================================
compartment_mol 100 LIP cell  # Initial LIP molecules
compartment_mol 20 TfR cell  # Initial TfR molecules
compartment_mol 15 Hamp cell  # Initial Hamp molecules
compartment_mol 50 Fe-FT cell  # Initial Fe-FT molecules
compartment_mol 50 FT cell  # Initial FT molecules
compartment_mol 20 Tf-Fe_intercell cell  # Initial Tf-Fe_intercell molecules
compartment_mol 100 Fpn cell  # Initial Fpn molecules
compartment_mol 50 HFE cell  # Initial HFE molecules
compartment_mol 20 TfR2 cell  # Initial TfR2 molecules


# Output settings
# ===============
output_files model_out.txt
cmd i 0 TIME_STOP 1 executiontime model_out.txt
cmd i 0 TIME_STOP 1 listmols model_out.txt

end_file
